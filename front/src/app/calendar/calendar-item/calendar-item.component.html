<button
  (click)="click($event)"
  type="button"
  cdkOverlayOrigin
  #trigger="cdkOverlayOrigin"
  class="container footnote"
  [class.selection]="selectionActive() === 'selection'"
  [class.selected]="selected()"
  [class.centered]="hideTitle"
  [ngClass]="event.event_type || event.type"
  [@slideDown]
>
  <div *ngIf="selectionActive() !== 'selection' && !hideTitle" translate>
    {{ "CALENDAR.EVENT_TYPE." + (event.event_type || event.type) }}
  </div>
  <div class="time">
    <span *ngIf="showDate">
      <ng-container *ngIf="hideTitle">
        {{ "AVAILABILITY.the_day" | translate }}
      </ng-container>
      {{ (event.start_time || event.startTime) | date : "shortDate" }}
      {{ "AVAILABILITY.from_hour" | translate | lowercase }}
    </span>
    <div
      *ngIf="hoursBetweenDates && hoursBetweenDates > 23; else range"
      translate
    >
      AVAILABILITY.all_day
    </div>
    <ng-template #range>
      {{ (event.start_time || event.startTime) | shortTime }}
      {{ showDate ? ("AVAILABILITY.to_hour" | translate | lowercase) : "-" }}
      {{ (event.end_time || event.endTime) | shortTime : showDate }}
    </ng-template>
  </div>
</button>

<ng-template
  cdkConnectedOverlay
  [cdkConnectedOverlayOrigin]="trigger"
  [cdkConnectedOverlayOpen]="isOpen"
  [cdkConnectedOverlayFlexibleDimensions]="true"
  [cdkConnectedOverlayPush]="true"
  [cdkConnectedOverlayPositions]="[
    {
      originX: 'end',
      originY: 'top',
      overlayX: 'start',
      overlayY: 'top',
      offsetX: 5,
    }
  ]"
  (overlayOutsideClick)="close($event)"
>
  <app-calendar-event-modal
    [event]="event"
    (close)="close()"
  ></app-calendar-event-modal>
</ng-template>
